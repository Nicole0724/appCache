var amaldar_stu="";var orderidval;var _url=Wsw.utils.GetUrl();$(function(){var b={func200:fnInit200};if(Wsw.utils.QueryString("status")!=null){amaldar_stu=Wsw.utils.QueryString("status");$.cookie.json=true;$.cookie("user_status",amaldar_stu)}else{if($.cookie("user_status")!=null&&$.cookie("user_status")!=undefined){amaldar_stu=$.cookie("user_status");amaldar_stu=amaldar_stu.replace(/"/g,"")}}var a="?status="+amaldar_stu;Wsw.login.isEmpower(b,a);if(Wsw.utils.QueryString("ispay")!=null&&Wsw.utils.QueryString("ispay")==="ok"){ispaySucss()}else{}});function fnInit200(){console.log($.cookie("user_status"));_url=_url.replace(/\&/g,"fuck");Wsw.utils.shareUrl(_url);wx.ready(function(){Wsw.utils.shareWeixin(1)});fnverify()}function fnverify(){$("#doc-vld-msg").validator({validate:function(a){var d=$(a.field).val();if($(a.field).is(".js-pattern-sfz")){var c=/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/;var b=/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X|x)$/;if(!c.exec(d)&&!b.exec(d)){a.valid=false}else{a.valid=true}}},onValid:function(a){$(a.field).closest(".am-form-group").find(".am-alert").hide()},onInValid:function(a){var c=$(a.field);var b=c.closest(".am-form-group");var d=b.find(".am-alert");var e=c.data("validationMessage")||this.getValidationMessage(a);if(!d.length){d=$('<div class="am-alert am-alert-danger"></div>').hide().appendTo(b)}d.html(e).show()},submit:function(){var a=this.isFormValid();if(a){isRegExam()}return false}})}function initExamDate(){var c={};var a={func200:b};Wsw.funs.excuteQuery("/exam/info",c,true,false,false,a);function b(f){$("#doc-select-1").empty();var d="";d+='<option value="">选择要考试的事件</option>';for(var e=0;e<f.rows.length;e++){d+=' <option value="'+f.rows[e].issue+'">'+f.rows[e].title+"</option>"}$("#doc-select-1").append(d)}}function isRegExam(){var e=$("input[name='userName']").val().trim();var d=$("input[name='userIdcard']").val().trim();var b={name:e,idcard:d};var a={func200:c};Wsw.funs.excuteQuery("/exam/signup/info/my",b,true,false,false,a);function c(f){if(f.rows.length==0){regExam()}else{$("#my-alert").modal("open")}}}function regExam(){console.log(amaldar_stu);var h=$("input[name='userName']").val().trim();var e=$("input[name='userIdcard']").val().trim();var g=$("input[name='userTel']").val().trim();var d=$("input[name='userEmail']").val().trim().toString();var i=$("input[name='managerId']").val().trim();var c={issue:999999,name:h,idcard:e,mobile:g,email:d,valicode:"0000",publiccode:amaldar_stu};var b={func200:a,func400:f};Wsw.funs.excuteQuery("/exam/signup",c,true,false,false,b);function a(j){orderidval=j.rows.orderid;$.cookie.json=true;$.cookie("user_orderid",orderidval);$.cookie("userInfo",j.rows);fntck()}function f(){$("#my-alert-2").modal("open");$("#my-alert-2 .am-modal-bd").text("信息提交失败，该身份证已报名，请核对你的报名信息！")}}function fntck(){$("#my-confirm").modal({relatedTarget:this,onConfirm:function(a){weChatPay()},onCancel:function(){}})}function weChatPay(){$.ajax({type:"post",url:"http://v.wasowa.cn/apiv1/wechat/userpay",dataType:"json",async:false,data:{cid:orderidval,type:"reg"},success:function(a){if(a!=null){wx.ready(function(){Wsw.utils.chooseWXPay(a.row,Wsw.utils.GetUrl())})}}})}function ispaySucss(){var a="";if($.cookie("user_orderid")!=undefined&&$.cookie("user_orderid")!=null&&$.cookie("user_orderid")!=""){a=$.cookie("user_orderid")}$.ajax({type:"post",url:Wsw.config.getApi("/exam/pay/status"),dataType:"json",async:false,data:{orderid:a},success:function(b){if(b==1){location.href="result.html"}else{$("#my-alert-2").modal("open");$("#my-alert-2 .am-modal-bd").text("报名失败，请重新报名！")}}})};